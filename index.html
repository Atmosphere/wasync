<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Wasync : WebSockets with fallback transports client library for Node.js, Android and Java" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Wasync</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/Atmosphere/wasync">View on GitHub</a>

          <h1 id="project_title">Wasync</h1>
          <h2 id="project_tagline">WebSockets with fallback transports client library for Node.js, Android and Java</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/Atmosphere/wasync/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/Atmosphere/wasync/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2>
<a name="wasync-a-websocketshttp-client-library-for-asynchronous-communication" class="anchor" href="#wasync-a-websocketshttp-client-library-for-asynchronous-communication"><span class="octicon octicon-link"></span></a>wAsync: A WebSockets/HTTP Client Library for Asynchronous Communication</h2>

<p>wAsync is a Java based library allowing asynchronous communication with any WebServer supporting the WebSocket or Http Protocol.
wAsync can be used with Node.js, Android, Atmosphere or any WebSocket Framework. To get started, read this super simple <a href="https://github.com/Atmosphere/wasync/wiki/Getting-Started-with-wAsync">Tutorial</a></p>

<p>You can browse the <a href="http://atmosphere.github.com/wasync/apidocs/">javadoc</a> or browse our <a href="https://github.com/Atmosphere/wasync/tree/master/samples">samples</a>.</p>

<p>You can <a href="http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22wasync%22">download the jar</a> or use Maven</p>

<div class="highlight highlight-xml"><pre>          <span class="nt">&lt;dependency&gt;</span>
              <span class="nt">&lt;groupId&gt;</span>org.atmosphere<span class="nt">&lt;/groupId&gt;</span>
              <span class="nt">&lt;artifactId&gt;</span>wasync<span class="nt">&lt;/artifactId&gt;</span>
              <span class="nt">&lt;version&gt;</span>1.0.0.RC5<span class="nt">&lt;/version&gt;</span>
          <span class="nt">&lt;/dependency&gt;</span>

</pre></div>

<p>As simple as</p>

<div class="highlight highlight-java"><pre>        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">newClient</span><span class="o">();</span>

        <span class="n">RequestBuilder</span> <span class="n">request</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">newRequestBuilder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">METHOD</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
                <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"http://async-io.org"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">encoder</span><span class="o">(</span><span class="k">new</span> <span class="n">Encoder</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Reader</span><span class="o">&gt;()</span> <span class="o">{</span>        <span class="c1">// Stream the request body</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="n">Reader</span> <span class="nf">encode</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="k">new</span> <span class="nf">StringReader</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">})</span>
                <span class="o">.</span><span class="na">decoder</span><span class="o">(</span><span class="k">new</span> <span class="n">Decoder</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Reader</span><span class="o">&gt;()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="n">Reader</span> <span class="nf">decode</span><span class="o">(</span><span class="n">Event</span> <span class="n">type</span><span class="o">,</span> <span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="k">new</span> <span class="nf">StringReader</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">})</span>
                <span class="o">.</span><span class="na">transport</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">TRANSPORT</span><span class="o">.</span><span class="na">WEBSOCKET</span><span class="o">)</span>                        <span class="c1">// Try WebSocket</span>
                <span class="o">.</span><span class="na">transport</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">TRANSPORT</span><span class="o">.</span><span class="na">LONG_POLLING</span><span class="o">);</span>                    <span class="c1">// Fallback to Long-Polling</span>

        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="n">socket</span><span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Reader</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">(</span><span class="n">Reader</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// Read the response</span>
            <span class="o">}</span>
        <span class="o">}).</span><span class="na">on</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">IOException</span><span class="o">&gt;()</span> <span class="o">{</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// Some IOException occurred</span>
            <span class="o">}</span>

        <span class="o">}).</span><span class="na">open</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">build</span><span class="o">())</span>
            <span class="o">.</span><span class="na">fire</span><span class="o">(</span><span class="s">"echo"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">fire</span><span class="o">(</span><span class="s">"bong"</span><span class="o">);</span>
</pre></div>

<p>Life cycle of the underlying Socket can easily be implemented as well</p>

<div class="highlight highlight-java"><pre>
           <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
           <span class="n">socket</span><span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="n">Event</span><span class="o">.</span><span class="na">CLOSE</span><span class="o">.</span><span class="na">name</span><span class="o">(),</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
               <span class="nd">@Override</span>
               <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">(</span><span class="n">String</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
               <span class="o">}</span>
           <span class="o">}).</span><span class="na">on</span><span class="o">(</span><span class="n">Event</span><span class="o">.</span><span class="na">REOPENED</span><span class="o">.</span><span class="na">name</span><span class="o">(),</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
               <span class="nd">@Override</span>
               <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">(</span><span class="n">String</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
               <span class="o">}</span>
           <span class="o">}).</span><span class="na">on</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">IOException</span><span class="o">&gt;()</span> <span class="o">{</span>
               <span class="nd">@Override</span>
               <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">(</span><span class="n">IOException</span> <span class="n">ioe</span><span class="o">)</span> <span class="o">{</span>
                   <span class="n">ioe</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
               <span class="o">}</span>
           <span class="o">}).</span><span class="na">on</span><span class="o">(</span><span class="n">Event</span><span class="o">.</span><span class="na">OPEN</span><span class="o">.</span><span class="na">name</span><span class="o">(),</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
               <span class="nd">@Override</span>
               <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">(</span><span class="n">String</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
               <span class="o">}</span>
           <span class="o">}).</span><span class="na">open</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">build</span><span class="o">());</span>
</pre></div>

<p>You can also use the specialized clients. For example, to transparently enable Atmosphere's Protocol</p>

<div class="highlight highlight-java"><pre>       <span class="n">AtmosphereClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">newClient</span><span class="o">(</span><span class="n">AtmosphereClient</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

       <span class="n">RequestBuilder</span> <span class="n">request</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">newRequestBuilder</span><span class="o">()</span>
               <span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">METHOD</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
               <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="n">targetUrl</span> <span class="o">+</span> <span class="s">"/suspend"</span><span class="o">)</span>
               <span class="o">.</span><span class="na">trackMessageLength</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
               <span class="o">.</span><span class="na">transport</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">TRANSPORT</span><span class="o">.</span><span class="na">LONG_POLLING</span><span class="o">);</span>
</pre></div>

<p>or if you want to serialize the fire() method call so events are asynchronously sent in the order the fire method is called</p>

<div class="highlight highlight-java"><pre>        <span class="n">SerializedClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientFactory</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">newClient</span><span class="o">(</span><span class="n">SerializedClient</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">SerializedOptionsBuilder</span> <span class="n">b</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">newOptionsBuilder</span><span class="o">();</span>
        <span class="n">b</span><span class="o">.</span><span class="na">serializedFireStage</span><span class="o">(</span><span class="k">new</span> <span class="n">DefaultSerializedFireStage</span><span class="o">());</span>

        <span class="n">RequestBuilder</span> <span class="n">request</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">newRequestBuilder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">METHOD</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
                <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="n">targetUrl</span> <span class="o">+</span> <span class="s">"/suspend"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">transport</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">TRANSPORT</span><span class="o">.</span><span class="na">WEBSOCKET</span><span class="o">);</span>

        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">build</span><span class="o">());</span>
</pre></div>

<p>By default, the <a href="http://atmosphere.github.com/wasync/apidocs/org/atmosphere/wasync/FunctionResolver.html">FunctionResolver</a> will associate the Decoder's type will be used to invoke the appropriate Function, if defined. For
example,</p>

<div class="highlight highlight-java"><pre>   <span class="n">Decoder</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">POJO</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Decoder</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">POJO</span><span class="o">&gt;()</span> <span class="o">{</span>
             <span class="nd">@Override</span>
             <span class="kd">public</span> <span class="n">POJO</span> <span class="nf">decode</span><span class="o">(</span><span class="n">Event</span> <span class="n">type</span><span class="o">,</span> <span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
                 <span class="k">if</span> <span class="o">(</span><span class="n">type</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">Event</span><span class="o">.</span><span class="na">MESSAGE</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="k">new</span> <span class="nf">POJO</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
                 <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">s</span><span class="o">;</span>
                 <span class="o">}</span>
             <span class="o">}</span>
         <span class="o">}</span>
</pre></div>

<p>will be associated to</p>

<div class="highlight highlight-java"><pre>   <span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">POJO</span><span class="o">&gt;()</span> <span class="o">{</span>
             <span class="nd">@Override</span>
             <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">(</span><span class="n">POJO</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>

             <span class="o">}</span>
        <span class="o">}</span>
</pre></div>

<p>You can also implement your own FunctionResolver to associate the Function with Decoder</p>

<div class="highlight highlight-java"><pre>         <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
         <span class="n">socket</span><span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="s">"myEvent"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Reader</span><span class="o">&gt;()</span> <span class="o">{</span> <span class="o">...}</span>
</pre></div>

<p>where myEvent could be read from the response's body.</p>

<p>Want to write an Android Client? <a href="http://jfarcand.wordpress.com/2013/04/04/wasync-websockets-with-fallbacks-transports-for-android-node-js-and-atmosphere/">See</a></p>

<p><a href="http://githalytics.com/Atmosphere/wasync"><img src="https://cruel-carlota.pagodabox.com/6565d992c41200f6a5617e646f291569" alt="githalytics.com alpha" title="githalytics.com"></a></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Wasync maintained by <a href="https://github.com/Atmosphere">Atmosphere</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
